$(document).ready(function(){function a(){var a={responseType:"json"};$.ajax({type:"POST",url:"../ajax.php",dataType:"json",data:{ajax:!0,"function":"setUpDatabaseTables",args:a}}).done(function(a){$("#installation-text").html(a.msg),$("#installing .progress-bar").attr("aria-valuenow",a.progress).attr("style","width:"+a.progress+"%;").html(a.progress+"%"),e()}).fail(function(a,e,t){})}function e(){var a={name:$("#name").val(),username:$("#username").val(),password:$("#password").val(),email:$("#email").val(),responseType:"json"};$.ajax({type:"POST",url:"../ajax.php",dataType:"json",data:{ajax:!0,"function":"seedDatabaseTables",args:a}}).done(function(a){$("#installation-text").html(a.msg),$("#installing .progress-bar").attr("aria-valuenow",a.progress).attr("style","width:"+a.progress+"%;").html(a.progress+"%"),setTimeout(function(){$("#installing").fadeOut(400,function(a){$("#complete").fadeIn()})},3e3)}).fail(function(a,e,t){})}$wizard=$("#wizard"),$wizard.on("click","#check-connection",function(a){if(a.preventDefault(),$(this).hasClass("working"))return!1;$(this).addClass("working").html('<i class="fa fa-spinner fa-spin"></i> Checking...');var e={host:$("#dbHost").val(),table:$("#dbTable").val(),user:$("#dbUser").val(),pass:$("#dbPass").val(),responseType:"json"};$("#errorMsg").html(""),$.ajax({type:"POST",url:"../ajax.php",dataType:"json",data:{ajax:!0,"function":"checkConnection",args:e}}).done(function(a){a.error?($("#check-connection").removeClass("working"),$("#errorMsg").html('<div class="alert alert-danger bs3-btn-padding margin-t-20 margin-b-0" role="alert">'+a.msg+"</div>"),$("#check-connection").html("Check Connection"),"showCreateDB"==a.extra&&$("#create-database").fadeIn()):($("#check-connection").removeClass("btn-default").addClass("btn-success").html("Connection Success!"),$("#step1").attr("data-complete",1),$("#gotoStep2").fadeIn())}).fail(function(a,e,t){$("#check-connection").removeClass("working")})}),$wizard.on("click","#create-database",function(a){if(a.preventDefault(),$(this).hasClass("working"))return!1;$(this).addClass("working").html('<i class="fa fa-spinner fa-spin"></i> Creating...');var e={host:$("#dbHost").val(),table:$("#dbTable").val(),user:$("#dbUser").val(),pass:$("#dbPass").val(),responseType:"json"};$("#errorMsg").html(""),$.ajax({type:"POST",url:"../ajax.php",dataType:"json",data:{ajax:!0,"function":"createDatabase",args:e}}).done(function(a){$("#create-database").removeClass("working"),a.error?($("#errorMsg").html('<div class="alert alert-danger bs3-btn-padding margin-t-20 margin-b-0" role="alert">'+a.msg+"</div>"),$("#create-database").html("Create Database")):($("#create-database").fadeOut(),$("#check-connection").trigger("click"))}).fail(function(a,e,t){$("#create-database").removeClass("working")})}),$wizard.on("input keyup blur",".required",function(a){var e=pass2=pass3=!0;$(this).closest('[role="tabpanel"]').hasClass("step1")&&($step1=$("#step1 .required"),$step1Count=$step1.length,$step1Count>1&&($("#check-connection").hasClass("btn-success")&&($("#check-connection").removeClass("btn-success").addClass("btn-default").html("Check Connection"),$("#gotoStep2").fadeOut(400),$('[href="#step1"]').removeClass("completed").html("Step 1"),$("#step1").attr("data-complete",0)),$("#errorMsg").html(""),$.each($step1,function(a,t){(""==$(t).val()||null===$(t).val())&&(e=!1)})),1==e?$("#check-connection").slideDown():$("#check-connection").slideUp()),$(this).closest('[role="tabpanel"]').hasClass("step2")&&($step2=$("#step2 .required"),$step2Count=$step2.length,$step2Count>1&&$.each($step2,function(a,e){(""==$(e).val()||null===$(e).val())&&(pass2=!1)}),1==pass2?$("#gotoStep3").fadeIn():$("#gotoStep3").fadeOut()),$(this).closest('[role="tabpanel"]').hasClass("step3")&&($step3=$("#step3 .required"),$step3Count=$step3.length,$step3Count>1&&$.each($step3,function(a,e){(""==$(e).val()||null===$(e).val())&&(pass3=!1)}),1==pass3?$("#complete-install").fadeIn():$("#complete-install").fadeOut())}),$wizard.on("click",'[href="#step1"], [href="#step2"], [href="#step3"], [href="#step4"]',function(a){$(this).hasClass("completed")||(a.preventDefault(),a.stopPropagation())}),$wizard.on("click","#gobackStep2",function(a){a.preventDefault(),$("#tab-wizard li:eq(0) a").tab("show")}),$wizard.on("click","#gotoStep2",function(a){a.preventDefault(),$("#tab-wizard li:eq(1) a").tab("show"),$('[href="#step1"]').addClass("completed").html('<span class="label label-success">Connect Database</span>')}),$wizard.on("click","#gobackStep3",function(a){a.preventDefault(),$("#tab-wizard li:eq(1) a").tab("show")}),$wizard.on("click","#gotoStep3",function(a){a.preventDefault(),$("#tab-wizard li:eq(2) a").tab("show"),$('[href="#step2"]').addClass("completed").html('<span class="label label-success">Administrator Setup</span>'),$("#ptsToWin").blur()}),$("#quickGame").on("click",function(a){$("#quickStandGame").find("button").removeClass("active"),$(this).addClass("active"),$("#ptsToWin").val(11),$("#ptsPerTurn").val(2),$("#skunk").val(5),$("#weeksPerSeason").val(2)}),$("#standGame").on("click",function(a){$("#quickStandGame").find("button").removeClass("active"),$(this).addClass("active"),$("#ptsToWin").val(21),$("#ptsPerTurn").val(5),$("#skunk").val(7),$("#weeksPerSeason").val(2)}),$wizard.on("click","#complete-install",function(e){e.preventDefault(),$wizard.fadeOut(400,function(a){$("#installing").fadeIn()}),setInterval(function(){var a=$("#dot-loader").html();""==a?a=".":"."==a?a="..":".."==a&&(a=""),$("#dot-loader").html(a)},1e3);var t={host:$("#dbHost").val(),table:$("#dbTable").val(),user:$("#dbUser").val(),pass:$("#dbPass").val(),responseType:"json"};$.ajax({type:"POST",url:"../ajax.php",dataType:"json",data:{ajax:!0,"function":"install",args:t}}).done(function(e){$("#installation-text").html(e.msg),$("#installing .progress-bar").attr("aria-valuenow",e.progress).attr("style","width:"+e.progress+"%;").html(e.progress+"%"),a()}).fail(function(a,e,t){})})});
