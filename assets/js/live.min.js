$(document).ready(function(){function e(){var e={responseType:"json"};$.ajax({type:"POST",url:"../ajax.php",dataType:"json",data:{ajax:!0,"function":"checkForLiveMatch",args:e}}).done(function(e){if(e.currentMatch){l(e.player1Score,e.player2Score,e);var t=e.totalTime.split(":");$time.fadeIn(),$time.find(".hours").html(t[0]),$time.find(".minutes").html(t[1]),$time.find(".seconds").html(t[2]),i=parseInt(t[2])+60*parseInt(t[1]),setInterval(n,1e3),$("#live-loader").hide(),$("#table-tennis").slideDown(400,function(l){$player1.find(".player").html(e.player1).fadeIn(),$player2.find(".player").html(e.player2).fadeIn(400,function(l){$player1.find(".score").html(e.player1Score).fadeIn(),$player2.find(".score").html(e.player2Score).fadeIn(),setInterval(a,1e4)})})}else $("#live-checker").fadeIn(),$("#live-loader-text").html(r)}).fail(function(e,a,l){console.log("FAILED")})}function a(){var e={responseType:"json"};$.ajax({type:"POST",url:"../ajax.php",dataType:"json",data:{ajax:!0,"function":"checkForLiveMatch",args:e}}).done(function(e){e.currentMatch?(console.log(e),$player1.find(".score").html(e.player1Score),$player2.find(".score").html(e.player2Score),l(e.player1Score,e.player2Score,e)):console.log("do winner display!")}).fail(function(e,a,l){console.log("FAILED")})}function l(e,a,l){o=e+a,$.inArray(o,p)>=0||0==o?$pongBall.removeClass("service-right"):$pongBall.addClass("service-right"),l.ptsToWin-1==e?$pongBall.removeClass("service-right"):l.ptsToWin-1==a&&$pongBall.addClass("service-right"),l.ptsToWin-1==e&&l.ptsToWin-1==a&&($player1.find(".player-msg").html('<span class="label label-info">Deuce</span>'),$player2.find(".player-msg").html('<span class="label label-info">Deuce</span>'),$pongBall.fadeOut()),l.ptsToWin==e&&l.ptsToWin!=a&&($player1.find(".player-msg").html('<span class="label label-success">Winner</span>'),$player2.find(".player-msg").html("")),l.ptsToWin!=e&&l.ptsToWin==a&&($player1.find(".player-msg").html(""),$player2.find(".player-msg").html('<span class="label label-success">Winner</span>'))}function n(){++i;parseInt($time.find(".minutes").html()),parseInt($time.find(".seconds").html());$time.find(".seconds").html(t(i%60)),$time.find(".minutes").html(t(parseInt(i/60)))}function t(e){var a=e+"";return a.length<2?"0"+a:a}var r="No Matches In Progress Currently",s='Looking for a live match<div class="loading-dots">...</div>',i=0,o=0,p=[0,1,4,5,8,9,12,13,16,17,20];$pongBall=$("#pong-ball"),$player1=$("#player1"),$player2=$("#player2"),$time=$("#time"),setTimeout(function(a){e()},2e3),$("#live-checker").on("click",function(a){$("#live-loader-text").html(s),e()})});
