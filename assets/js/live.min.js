$(document).ready(function(){function e(){var e={responseType:"json"};$.ajax({type:"POST",url:"../ajax.php",dataType:"json",data:{ajax:!0,"function":"checkForLiveMatch",args:e}}).done(function(e){if(console.log(e),e.currentMatch){n(e.player1Score,e.player2Score,e);var o=e.totalTime.split(":");$time.fadeIn(),$time.find(".hours").html(o[0]),$time.find(".minutes").html(o[1]),$time.find(".seconds").html(o[2]),r=parseInt(o[2])+60*parseInt(o[1]),setInterval(a,1e3),$("#live-loader").hide(),$("#table-tennis").slideDown(400,function(n){$player1.find(".player").html(e.player1).fadeIn(),$player2.find(".player").html(e.player2).fadeIn(400,function(n){$player1.find(".score").html(e.player1Score).fadeIn(),$player2.find(".score").html(e.player2Score).fadeIn(),setInterval(l,1e4)})})}else $("#live-checker").fadeIn(),$("#live-loader-text").html(s)}).fail(function(e,l,n){console.log("FAILED")})}function l(){var e={responseType:"json"};$.ajax({type:"POST",url:"../ajax.php",dataType:"json",data:{ajax:!0,"function":"checkForLiveMatch",args:e}}).done(function(e){e.currentMatch?(console.log(e),console.log("hit now"),$player1.find(".score").html(e.player1Score),$player2.find(".score").html(e.player2Score),n(e.player1Score,e.player2Score,e)):console.log("do winner display!")}).fail(function(e,l,n){console.log("FAILED")})}function n(e,l,n){i=e+l,console.log("serving"),console.log(i),$.inArray(i,p)>=0||0==i?(console.log("first player"),$pongBall.removeClass("service-right")):(console.log("second player"),$pongBall.addClass("service-right")),n.ptsToWin-1==e?$pongBall.removeClass("service-right"):n.ptsToWin-1==l&&$pongBall.addClass("service-right"),n.ptsToWin-1==e&&n.ptsToWin-1==l&&($player1.find(".player-msg").html('<span class="label label-info">Deuce</span>'),$player2.find(".player-msg").html('<span class="label label-info">Deuce</span>'),$pongBall.fadeOut()),n.ptsToWin==e&&n.ptsToWin!=l&&($player1.find(".player-msg").html('<span class="label label-success">Winner</span>'),$player2.find(".player-msg").html("")),n.ptsToWin!=e&&n.ptsToWin==l&&($player1.find(".player-msg").html(""),$player2.find(".player-msg").html('<span class="label label-success">Winner</span>'))}function a(){++r;parseInt($time.find(".minutes").html()),parseInt($time.find(".seconds").html());$time.find(".seconds").html(o(r%60)),$time.find(".minutes").html(o(parseInt(r/60)))}function o(e){var l=e+"";return l.length<2?"0"+l:l}var s="No Matches In Progress Currently",t='Looking for a live match<div class="loading-dots">...</div>',r=0,i=0,p=[0,1,4,5,8,9,12,13,16,17,20];$pongBall=$("#pong-ball"),$player1=$("#player1"),$player2=$("#player2"),$time=$("#time"),setTimeout(function(l){e()},2e3),$("#live-checker").on("click",function(l){$("#live-loader-text").html(t),e()})});
